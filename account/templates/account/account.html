{% extends 'base.html' %}
{% load static %}

{% block title %}Profile
{% endblock title %}

{% block body %}

<style>
    .profile-card {
        width: 400px;
    }
</style>

<div class="d-flex flex-row">
    <div class="card  profile-card">
        <div class="card-header">Profile</div>
        <div class="card-body align-items-center">
            <div class="d-flex flex-column align-items-center justify-content-center">
            <div class="img-container d-flex flex-column mb-4">
                <img class="border border-2 border-success" src="{% static 'images/default_profile.png' %}"
                    alt="profile image" width="200" height="200">
                {% if is_self %}
                <button class="btn btn-primary btn-sm" onclick="handleEditImage()">Edit Image</button>
                {% endif %}
            </div>
                <p class="mb-1 mt-3 field-heading">Name</p>
                <h5>{{name|capfirst}}</h5>
                <p class='mb-1 mt-3 field-heading'>Email</p>
                {% if is_self %}
                    <h5>{{ email }}</h5>
                {% else %}
                    {% if hide_email %}
                        <h5>***************</h5>
                    {% else %}
                        <h5>{{ email }}</h5>
                    {% endif %}
                {% endif %}
                <p class="mb-1 mt-3 field-heading">Username</p>
                <h5>{{username}}</h5>

                {% if is_self %}
                <div class="d-flex flex-column my-4">
                    <a href="{% url 'account:edit' user_id=id %}" class="btn btn-primary mb-3">Update</a>
                    <a href="#">Change Password</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="d-flex flex-column">
        {% if is_self %}
            <div class="card ms-4 mb-2">
                <div class="card-body">
                <h3><a href="#">Friends ({{ friends|length }})</a></h3>
                </div>
            </div>
            <div class="card ms-4 mb-2">
            <div class="card-header">Pending Friend Requests</div>
            <div class="card-body">
                {% for friend_req in friend_requests %}
                    <div class="d-flex flex-column">
                        <div id="{{ friend_req.id }}">{{ friend_req.sender }}
                        <a href="#"> accept </a> <a href="#"> decline</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
            </div>
        {% endif %}

        {% if is_friend %}
            <div class="card ms-4 mb-2">
                <div class="card-body">
                <h3><a href="#">Remove Friend</a></h3>
                </div>
            </div>
        {% else %}
            {% if is_friend == False and request_sent == 1 %}
                <div class="card ms-4 mb-2">
                <div class="card-body">
                <h3><a href="#">Send Friend Request</a></h3>
                </div>
            </div>
            {% endif %}

            {% if is_friend == False and request_sent == 2 %}
                <div class="card ms-4 mb-2">
                <div class="card-body">
                <h3><a href="#">Cancel Friend Request</a></h3>
                </div>
            </div>
            {% endif %}

            {% if is_friend == False and request_sent == 3 %}
                <div class="card ms-4 mb-2">
                <div class="card-body">
                <div class="d-flex flex-row">
                        <div id="{{ pending_friend_req_id }}">
                        <a href="#"> accept </a> <a href="#"> decline</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

        {% endif %}
    </div>
    
</div>
{% endblock body %}

{% block script %}
<script>
function handleEditImage(){
    alert('This feature will be implemented soon')
}
</script>
{% endblock script %}